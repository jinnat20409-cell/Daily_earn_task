<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>Mini App Demo</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#fff; color:#000; }
    .container { padding:15px; }
    .section { display:none; }
    .section.active { display:block; }
    .navbar { position:fixed; bottom:0; left:0; width:100%; display:flex; justify-content:space-around; background:#f0f0f0; padding:10px 0; border-top:1px solid #ccc; }
    .navbar button { flex:1; border:none; background:none; font-size:16px; cursor:pointer; padding:10px; transition:0.3s; }
    .navbar button.active { background:#000; color:#fff; border-radius:8px; }
    .card { padding:15px; margin:10px 0; border-radius:10px; border:1px solid #ddd; background:#fafafa; }
    .input-field { padding:10px; border:1px solid #ccc; border-radius:5px; width:100%; margin-bottom:10px; }
    .button { background:#000; color:#fff; padding:10px 15px; border:none; border-radius:8px; cursor:pointer; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Home -->
    <div id="home" class="section active">
      <h2 id="welcome">Welcome!</h2>
      <p><b>Name:</b> <span id="tgName">Loading...</span></p>
      <div class="card">
        <p><b>Total Income:</b> <span id="income">0</span> ৳</p>
        <p><b>Ads Watched:</b> <span id="adsCount">0</span></p>
        <p><b>Referrals:</b> <span id="refCount">0</span></p>
      </div>
    </div>

    <!-- Earn -->
    <div id="earn" class="section">
      <h2>Earn Rewards</h2>
      <div class="card">
        <p>Watch Ads & Earn Points</p>
        <!-- Monetag Ads -->
        <div id="monetag-ad"></div>
        <button class="button" onclick="watchAd()">Earn by Watching Ad</button>
      </div>
      <div class="card">
        <p>Join Telegram Channels</p>
        <button class="button">Join Channel 1</button>
        <button class="button">Join Channel 2</button>
        <button class="button">Join Channel 3</button>
      </div>
    </div>

    <!-- Withdraw -->
    <div id="withdraw" class="section">
      <h2>Withdraw</h2>
      <p><b>Balance:</b> <span id="balanceWithdraw">0</span> ৳</p>
      <select id="paymentMethod" class="input-field">
        <option value="">Select Method</option>
        <option value="bkash">Bkash</option>
        <option value="nagad">Nagad</option>
        <option value="paypal">PayPal</option>
      </select>
      <input type="text" id="paymentDetails" class="input-field" placeholder="Enter Account Details">
      <input type="number" id="withdrawAmount" class="input-field" placeholder="Enter Amount">
      <button class="button" onclick="requestWithdraw()">Submit Withdraw</button>
    </div>

    <!-- Profile -->
    <div id="profile" class="section">
      <h2>Profile</h2>
      <p><b>Name:</b> <span id="profileName">Loading...</span></p>
      <p><b>Username:</b> <span id="profileUsername">@user</span></p>
      <p><b>Balance:</b> <span id="profileBalance">0</span> ৳</p>
      <p><b>Ads Watched:</b> <span id="profileAds">0</span></p>
      <p><b>Referrals:</b> <span id="profileRefs">0</span></p>
      <div class="card">
        <p>Your Referral Link:</p>
        <input type="text" id="refLink" class="input-field" readonly>
        <button class="button" onclick="copyRefLink()">Copy Link</button>
      </div>
    </div>
  </div>

  <!-- Navbar -->
  <div class="navbar">
    <button class="active" onclick="showSection('home', this)">Home</button>
    <button onclick="showSection('earn', this)">Earn</button>
    <button onclick="showSection('withdraw', this)">Withdraw</button>
    <button onclick="showSection('profile', this)">Profile</button>
  </div>

  <script>
    // Telegram Bot Setup
    const BOT_TOKEN = "7567052001:AAHrSf6mQPzIsI-_h-zHbYPPaoxO1OMZSH0"; 
    const ADMIN_CHAT_ID = "6750565670"; 
    const TELEGRAM_API = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

    // Monetag Ads Setup
    const MONETAG_ZONE_ID = "YOUR_ZONE_ID"; // এখানে আপনার Monetag zone id বসাবেন
    document.getElementById("monetag-ad").innerHTML = `<script src="https://a.monetag.com/${MONETAG_ZONE_ID}"><\/script>`;

    // User Data (Local Storage)
    let user = {
      name: "@josimm123",
      username: "@josimm123",
      income: parseFloat(localStorage.getItem("income") || 0),
      ads: parseInt(localStorage.getItem("ads") || 0),
      refs: parseInt(localStorage.getItem("refs") || 0)
    };

    // Show Home/Profile Data
    function updateUI() {
      document.getElementById("tgName").innerText = user.name;
      document.getElementById("welcome").innerText = "Welcome " + user.name;
      document.getElementById("income").innerText = user.income;
      document.getElementById("adsCount").innerText = user.ads;
      document.getElementById("refCount").innerText = user.refs;
      document.getElementById("balanceWithdraw").innerText = user.income;
      document.getElementById("profileName").innerText = user.name;
      document.getElementById("profileUsername").innerText = user.username;
      document.getElementById("profileBalance").innerText = user.income;
      document.getElementById("profileAds").innerText = user.ads;
      document.getElementById("profileRefs").innerText = user.refs;
      document.getElementById("refLink").value = `https://t.me/MonetagMiniBot_bot?startapp=${ADMIN_CHAT_ID}`;
    }

    updateUI();

    // Navigation
    function showSection(id, btn) {
      document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      document.querySelectorAll(".navbar button").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    }

    // Earn by watching ads
    function watchAd() {
      user.ads += 1;
      user.income += 1; // প্রতি অ্যাডে 1 টাকা
      saveUser();
      updateUI();
    }

    // Withdraw Request
    async function requestWithdraw() {
      let amount = parseFloat(document.getElementById("withdrawAmount").value);
      let method = document.getElementById("paymentMethod").value;
      let details = document.getElementById("paymentDetails").value;

      if (amount > user.income) { alert("Insufficient Balance"); return; }
      if (amount < 10) { alert("Minimum withdraw 10"); return; }

      user.income -= amount;
      saveUser();
      updateUI();

      let msg = `Withdraw Request:\nUser: ${user.name}\nAmount: ${amount}\nMethod: ${method}\nDetails: ${details}`;
      await fetch(TELEGRAM_API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ chat_id: ADMIN_CHAT_ID, text: msg })
      });
      alert("Withdraw request sent!");
    }

    // Referral System (when new user joins with link)
    function addReferral() {
      user.refs += 1;
      user.income += 5; // রেফার বোনাস 5 টাকা
      saveUser();
      updateUI();
    }

    // Copy referral link
    function copyRefLink() {
      let copyText = document.getElementById("refLink");
      copyText.select(); 
      document.execCommand("copy");
      alert("Referral Link Copied!");
    }

    // Save user data
    function saveUser() {
      localStorage.setItem("income", user.income);
      localStorage.setItem("ads", user.ads);
      localStorage.setItem("refs", user.refs);
    }

    // Check referral from URL
    window.onload = function() {
      let params = new URLSearchParams(window.location.search);
      if (params.has("ref")) {
        addReferral();
      }
    };
  </script>
</body>
  </html>
